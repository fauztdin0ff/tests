{"version":3,"file":"main.js","sources":["../../src/js/main.js"],"sourcesContent":["// if (window.innerWidth >= 768) {\n//     const msnry = new Masonry(\".stories__items\", {\n//         itemSelector: \".stories-item\",\n//         columnWidth: \".stories-item--width\",\n//         gutter: \".stories-item--gap\",\n//         horizontalOrder: true,\n//         percentPosition: true,\n//     });\n// }\n\nconst forms = () => {\n    const $forms = document.querySelectorAll(\".js-mail-form\");\n\n    $forms.forEach(($form) => {\n        const $submit = $form.querySelector(\".js-submit\");\n\n        $submit.addEventListener(\"click\", (e) => {\n            e.preventDefault();\n\n            $form.dataset.errors = 0;\n\n            const $phone = $form.querySelector('input[name=\"phone\"]');\n            const $name = $form.querySelector('input[name=\"name\"]');\n            const $email = $form.querySelector('input[name=\"email\"]');\n\n            if ($phone) {\n                if ($phone.value.length == 0) {\n                    $phone.classList.add(\"is-error\");\n                    $form.dataset.errors++;\n                } else {\n                    $phone.classList.remove(\"is-error\");\n                }\n            }\n            if ($name) {\n                if ($name.value.length == 0) {\n                    $name.classList.add(\"is-error\");\n                    $form.dataset.errors++;\n                } else {\n                    $name.classList.remove(\"is-error\");\n                }\n            }\n            // if ($email) {\n            //     if ($email.value.length == 0) {\n            //         $email.classList.add(\"is-error\");\n            //         $form.dataset.errors++;\n            //     } else {\n            //         $email.classList.remove(\"is-error\");\n            //     }\n            // }\n\n            if ($form.dataset.errors > 0) {\n                $form.querySelector(\".js-warning\").style.display = \"block\";\n                return;\n            } else {\n                $form.querySelector(\".js-warning\").style.display = \"none\";\n            }\n\n            const formData = new FormData($form);\n\n            fetch(\"../mailer.php\", {\n                method: \"POST\",\n                body: formData,\n            })\n                .then(function (serverPromise) {\n                    return serverPromise.json();\n                })\n                .then(function (data) {\n                    if (data.error) {\n                        alert(data.error);\n                        return false;\n                    }\n                    alert(\"Сообщение отправлено\");\n                });\n        });\n    });\n};\n\nfunction resetSurvey() {\n    // const $box = document.getElementById('survey');\n    // if (!$box) return;\n    // $box.dataset.step = 1;\n    // $box.querySelectorAll('input').forEach(element => {\n    //     element.checked = false\n    // });\n}\n\nconst survey = () => {\n    let step = 1;\n    let steps_total;\n    let i = 1;\n    let is_last = false;\n\n    const $box = document.getElementById(\"survey\");\n    if (!$box) return;\n\n    const $steps = $box.querySelector(\".js-survey-steps\");\n    const $progress = $box.querySelector(\".js-survey-progress\");\n\n    steps_total = $steps.querySelectorAll(\".js-survey-step\").length;\n\n    const $prev = $box.querySelector(\".js-survey-prev\");\n    const $next = $box.querySelector(\".js-survey-next\");\n\n    function showResult(step) {\n        document.getElementById(\"popup-test\").style.backgroundImage =\n            \"url(./images/test-bg-4.jpg)\";\n\n        if (\n            getStepAnswer(1) == \"1\" &&\n            getStepAnswer(2) == \"1\" &&\n            getStepAnswer(3) == \"2\" &&\n            getStepAnswer(4) == \"2\" &&\n            getStepAnswer(5) == \"2\" &&\n            getStepAnswer(6) == \"2\"\n        ) {\n            showPopup(\"popup-survey-result-1\");\n        } else {\n            showPopup(\"popup-survey-result-2\");\n        }\n\n        setTimeout(() => {\n            hidePopup(\"popup-test\");\n        }, 1000);\n    }\n\n    const getStepAnswer = (step) => {\n        return $box\n            .querySelector('.js-survey-step[data-step=\"' + step + '\"]')\n            .querySelector('input[type=\"radio\"]:checked').value;\n    };\n\n    function showStep(step) {\n        const $form = $box.querySelector(\n            '.js-survey-step[data-step=\"' + step + '\"]'\n        );\n        if (!$form) return;\n\n        if (step <= 2) {\n            document.getElementById(\"popup-test\").style.backgroundImage =\n                \"url(./images/test-bg-1.jpg)\";\n        } else if (step <= 4) {\n            document.getElementById(\"popup-test\").style.backgroundImage =\n                \"url(./images/test-bg-2.jpg)\";\n        } else if (step <= 6) {\n            document.getElementById(\"popup-test\").style.backgroundImage =\n                \"url(./images/test-bg-3.jpg)\";\n        }\n\n        is_last = step == steps_total;\n\n        $steps.querySelectorAll(\".js-survey-step\").forEach((element) => {\n            element.classList.remove(\"is-active\");\n            element.style.opacity = 0;\n        });\n        $form.classList.add(\"is-active\");\n        setTimeout(() => {\n            $form.style.opacity = 1;\n        }, 0);\n\n        i = 1;\n        $progress\n            .querySelectorAll(\".survey__progress-step\")\n            .forEach((element) => {\n                if (i <= step) {\n                    element.classList.add(\"is-active\");\n                } else {\n                    element.classList.remove(\"is-active\");\n                }\n                i++;\n            });\n    }\n\n    i = 1;\n    $steps.querySelectorAll(\".js-survey-step\").forEach((element) => {\n        element.querySelectorAll(\"input\").forEach((radio) => {\n            radio.addEventListener(\"change\", function () {\n                $next.disabled = false;\n            });\n        });\n\n        const div = document.createElement(\"div\");\n        div.classList.add(\"survey__progress-step\");\n        if (i == 1) {\n            div.classList.add(\"is-active\");\n        }\n        $progress.appendChild(div);\n\n        i++;\n    });\n\n    $prev.addEventListener(\"click\", function (e) {\n        step--;\n        showStep(step);\n        $next.disabled = false;\n        if (step == 1) {\n            $prev.style.display = \"none\";\n        }\n        $prev.innerHTML = \"Шаг \" + (step - 1);\n        $next.innerHTML = \"Шаг \" + (step + 1);\n    });\n    $next.addEventListener(\"click\", function (e) {\n        $prev.style.display = \"block\";\n        $next.disabled = true;\n        if (!is_last) {\n            step++;\n            showStep(step);\n        } else {\n            showResult(step);\n            $box.querySelectorAll('input[type=\"radio\"]').forEach((radio) => {\n                radio.checked = false;\n            });\n            step = 1;\n            is_last = false;\n            $prev.style.display = \"none\";\n            setTimeout(() => {\n                showStep(step);\n            }, 1000);\n        }\n        $prev.innerHTML = \"Шаг \" + (step - 1);\n        if (!is_last) {\n            $next.innerHTML = \"Шаг \" + (step + 1);\n        } else {\n            $next.innerHTML = \"Отправить\";\n        }\n    });\n};\n\nconst accordion = () => {\n    document\n        .querySelectorAll(\".js-accordion .accordion__header\")\n        .forEach((el) => {\n            el.addEventListener(\"click\", function () {\n                const self = el\n                    .closest(\".accordion__item\")\n                    .classList.contains(\"is-active\");\n                const $btn = el.querySelector(\".button-arrow\");\n\n                if (self) return;\n\n                document.querySelectorAll(\".accordion__item\").forEach((el) => {\n                    const $btn = el.querySelector(\".button-arrow\");\n                    el.classList.remove(\"is-active\");\n                    $btn.classList.add(\"button-arrow--down\");\n                    $btn.classList.remove(\"button-arrow--up\");\n                    $btn.classList.remove(\"button-arrow--filled\");\n                });\n\n                $btn.classList.toggle(\"button-arrow--down\");\n                $btn.classList.toggle(\"button-arrow--up\");\n                $btn.classList.toggle(\"button-arrow--filled\");\n\n                el.closest(\".accordion__item\").classList.toggle(\"is-active\");\n            });\n        });\n};\n\nconst videos = () => {\n    document.querySelectorAll(\".video\").forEach((el) => {\n        el.addEventListener(\"click\", function (e) {\n            e.preventDefault();\n            if (this.classList.contains(\"is-active\") == false) {\n                this.classList.add(\"is-active\");\n                this.querySelector(\"video\").play();\n                this.querySelector(\"video\").addEventListener(\"ended\", () => {\n                    el.classList.remove(\"is-active\");\n                });\n                this.querySelector(\"video\").addEventListener(\"pause\", function() {\n                    if (this.readyState == 4) // trigger only on pause, not on seeked\n                        el.classList.remove(\"is-active\");\n                });\n            }\n        });\n    });\n};\n\nconst audioStop = () => {\n    document.querySelectorAll(\"audio\").forEach((audio) => {\n        audio.pause();\n    });\n};\n\nconst audio = () => {\n    const calculateTime = (secs) => {\n        const minutes = Math.floor(secs / 60);\n        const seconds = Math.floor(secs % 60);\n        const returnedSeconds =\n            seconds == 0 ? \"00\" : seconds < 10 ? `0${seconds}` : `${seconds}`;\n        const returnedMinutes =\n            minutes == 0 ? \"00\" : minutes < 10 ? `0${minutes}` : `${minutes}`;\n        return `${returnedMinutes}:${returnedSeconds}`;\n    };\n\n    document.querySelectorAll(\".audio\").forEach((el) => {\n        if (el.dataset.init == true) return;\n\n        const $audio = el.querySelector(\"audio\");\n        if (!$audio) return;\n\n        const $progress = el.querySelector(\".audio__duration\");\n\n        $audio.addEventListener(\"loadedmetadata\", () => {\n            $progress.textContent =\n                el.dataset.detailedDuration !== undefined\n                    ? \"00:00 / \" + calculateTime($audio.duration)\n                    : calculateTime($audio.duration);\n        });\n        $audio.addEventListener(\"timeupdate\", () => {\n            $progress.textContent =\n                el.dataset.detailedDuration !== undefined\n                    ? calculateTime(Math.floor($audio.currentTime)) +\n                      \" / \" +\n                      calculateTime($audio.duration)\n                    : calculateTime(\n                          $audio.duration - Math.floor($audio.currentTime)\n                      );\n        });\n\n        el.querySelector(\".audio__play .button-audio\").addEventListener(\n            \"click\",\n            () => {\n                el.querySelector(\".audio__play\").classList.remove(\"is-active\");\n                el.querySelector(\".audio__pause\").classList.add(\"is-active\");\n                $audio.play();\n            }\n        );\n\n        el.querySelector(\".audio__pause .button-audio\").addEventListener(\n            \"click\",\n            () => {\n                el.querySelector(\".audio__play\").classList.add(\"is-active\");\n                el.querySelector(\".audio__pause\").classList.remove(\"is-active\");\n                $audio.pause();\n            }\n        );\n\n        el.dataset.init = true;\n    });\n};\n\nfunction hidePopup(id) {\n    let popup = document.getElementById(id)\n        ? document.getElementById(id)\n        : this.closest(\".popup\");\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\")) {\n        popup.addEventListener(\n            \"transitionend\",\n            (e) => {\n                popup.style.display = \"none\";\n                popup.dataset.processing = false;\n            },\n            {\n                once: true,\n            }\n        );\n        popup.classList.remove(\"is-shown\");\n        document.body.classList.remove(\"no-scroll\");\n\n        if (id == \"popup-teacher\") {\n            audioStop();\n        }\n    }\n}\n\nfunction showPopup(id, dataset) {\n    let popup = document.getElementById(id);\n\n    if (id != \"popup-nav\") hidePopup(\"popup-nav\");\n    if (id != \"popup-signup-options\") hidePopup(\"popup-signup-options\");\n    if (id != \"popup-survey-result-1\") hidePopup(\"popup-survey-result-1\");\n    if (id != \"popup-survey-result-2\") hidePopup(\"popup-survey-result-2\");\n    if (id != \"popup-lesson\") hidePopup(\"popup-lesson\");\n    if (id != \"popup-teacher\") hidePopup(\"popup-teacher\");\n\n    if (id == \"popup-teacher\") {\n        audio();\n    }\n\n    if (id == \"popup-test\") {\n        preload_image(\"./images/test-bg-1.jpg\");\n        preload_image(\"./images/test-bg-2.jpg\");\n        preload_image(\"./images/test-bg-3.jpg\");\n        preload_image(\"./images/test-bg-4.jpg\");\n    }\n\n    if (dataset && dataset.subject !== undefined) {\n        document\n            .getElementById(\"popup-signup-form\")\n            .querySelector('input[name=\"subject\"]').value = dataset.subject;\n        document\n            .getElementById(\"popup-signup-form-second\")\n            .querySelector('input[name=\"subject\"]').value = dataset.subject;\n    }\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\") == false) {\n        if (dataset && dataset.file !== undefined) {\n            var xhr = new XMLHttpRequest();\n            xhr.open(\"GET\", dataset.file, true);\n            xhr.onreadystatechange = function () {\n                if (this.readyState !== 4) return;\n                if (this.status !== 200) return;\n                popup.querySelector(\".popup-window\").innerHTML =\n                    this.responseText;\n\n                if (id == \"popup-teacher\") {\n                    audio();\n                }\n            };\n            xhr.send();\n        }\n\n        popup.style.display = \"flex\";\n        setTimeout(function () {\n            popup.classList.add(\"is-shown\");\n            document.body.classList.add(\"no-scroll\");\n            popup.dataset.processing = false;\n        }, 1);\n    }\n}\n\nfunction preload_image(im_url) {\n    let img = new Image();\n    img.src = im_url;\n}\n\nfunction recalcPrices($container) {\n    const tab = $container.querySelector(\".js-tabs-button.is-active\");\n    const prices = JSON.parse(tab.dataset.prices)[\"prices\"];\n\n    let i = 0;\n\n    $container.querySelectorAll(\".prices-item__price-number\").forEach((el) => {\n        el.querySelector(\"span\").textContent = prices[i];\n        i++;\n    });\n}\n\nconst tabsInit = () => {\n    const tabs = document.querySelectorAll(\".js-tabs\");\n\n    if (!tabs) return;\n\n    tabs.forEach((el) => {\n        const tabButtons = el.querySelectorAll(\".js-tabs-button\"),\n            contents = el.querySelectorAll(\".js-tabs-content\");\n\n        if (!tabButtons) return;\n        if (!contents) return;\n\n        tabButtons.forEach((tab) => {\n            tab.addEventListener(\"click\", (e) => {\n                const id = e.target.dataset.id;\n\n                if (id) {\n                    tabButtons.forEach((btn) => {\n                        btn.classList.remove(\"is-active\");\n                    });\n                    e.target.classList.add(\"is-active\");\n\n                    contents.forEach((content) => {\n                        content.classList.remove(\"is-active\");\n                    });\n\n                    if (!document.getElementById(id)) return;\n\n                    const element = document.getElementById(id);\n                    element.classList.add(\"is-active\");\n                }\n\n                if (e.target.dataset.prices) {\n                    tabButtons.forEach((btn) => {\n                        btn.classList.remove(\"is-active\");\n                    });\n                    e.target.classList.add(\"is-active\");\n                    recalcPrices(el);\n                }\n            });\n        });\n    });\n};\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    accordion();\n    survey();\n    forms();\n    videos();\n    audio();\n    tabsInit();\n\n    IMask(document.querySelector(\".js-mask-phone\"), {\n        mask: \"+{7} (000) 000-00-00\",\n    });\n\n    document.querySelectorAll(\".popup\").forEach((el) => {\n        el.addEventListener(\"click\", function (e) {\n            if (e.target == el) {\n                hidePopup(e.target.id);\n            }\n        });\n    });\n    document.body.addEventListener(\"click\", function (e) {\n        const $close = e.target.closest(\".js-popup-hide\");\n        if ($close) {\n            e.preventDefault();\n            hidePopup.call($close);\n        }\n\n        const $show = e.target.closest(\".js-popup-show\");\n        if ($show) {\n            e.preventDefault();\n            showPopup($show.dataset.target, $show.dataset);\n        }\n    });\n\n    if (window.innerWidth >= 1280) {\n        const swiperClients = new Swiper(\".swiper-teachers\", {\n            slidesPerView: 4,\n            spaceBetween: 40,\n            // loop: true,\n            navigation: {\n                nextEl: \".swiper-teachers-next\",\n                prevEl: \".swiper-teachers-prev\",\n            },\n        });\n    }\n\n    if (document.querySelector(\".js-swiper-speak\")) {\n        const $swiperSpeakPages = document.querySelector(\n            \".js-swiper-speak-pagination\"\n        );\n        let progress = 0;\n        let realIndex;\n        let slidesqty = document\n            .querySelector(\".js-swiper-speak\")\n            .querySelectorAll(\".swiper-slide\").length;\n        for (let index = 0; index < slidesqty; index++) {\n            const div = document.createElement(\"div\");\n            div.classList.add(\"speak__card__slider-page\");\n            div.classList.add(\"js-swiper-speak-page\");\n            $swiperSpeakPages.appendChild(div);\n        }\n        const swiperClients = new Swiper(\".js-swiper-speak\", {\n            autoplay: {\n                delay: 2500,\n                disableOnInteraction: false,\n            },\n            on: {\n                autoplayTimeLeft(s, time, progress) {\n                    progress = Math.round((1 - progress) * 100);\n                    $swiperSpeakPages.style.setProperty(\n                        \"--progress\",\n                        progress + \"%\"\n                    );\n                },\n                init: function (s) {},\n                slideChange: function (s) {\n                    if (s.realIndex != realIndex) {\n                        $swiperSpeakPages\n                            .querySelectorAll(\".js-swiper-speak-page\")\n                            .forEach((el) => {\n                                el.classList.remove(\"is-active\");\n                            });\n                        $swiperSpeakPages\n                            .querySelectorAll(\".js-swiper-speak-page\")\n                            [s.realIndex].classList.add(\"is-active\");\n\n                        realIndex = s.realIndex;\n                    }\n                },\n            },\n            slidesPerView: \"auto\",\n            spaceBetween: 20,\n            loop: true,\n        });\n    }\n});\n"],"names":["forms","$forms","document","querySelectorAll","forEach","$form","$submit","querySelector","addEventListener","e","preventDefault","dataset","errors","$phone","$name","$email","value","length","classList","add","remove","style","display","formData","FormData","then","serverPromise","json","data","error","survey","step","steps_total","i","is_last","$box","getElementById","$steps","$progress","$prev","$next","showResult","backgroundImage","getStepAnswer","showStep","element","opacity","radio","disabled","div","createElement","appendChild","innerHTML","checked","accordion","el","self","closest","contains","$btn","toggle","videos","play","readyState","audioStop","audio","pause","calculateTime","secs","minutes","Math","floor","seconds","returnedSeconds","returnedMinutes","init","$audio","textContent","detailedDuration","undefined","duration","currentTime","hidePopup","id","popup","processing","body","showPopup","subject","file","xhr","XMLHttpRequest","open","onreadystatechange","status","responseText","send","preload_image","im_url","img","Image","src","recalcPrices","$container","tab","prices","JSON","parse","tabsInit","tabs","tabButtons","contents","target","btn","content","$close","call","$show","window","innerWidth","swiperClients","Swiper","$swiperSpeakPages","realIndex","slidesqty","index","s","time","progress","round","setProperty"],"mappings":"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"}